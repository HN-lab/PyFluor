# **PyFluor**

This is a Python script developed to facilitate analysis and graphical visualization of fluorescence reader output files of biological experiments in Multi-well Plate setup. The script has been developed keeping in mind the analysis and visualization of high-throughput cell-free transcription and translation (TX-TL) experiments, however, its usage can further be expanded to the analysis of fluorescence reporter assays, generating heatmaps to visualize the effect of titrating reagents in a reaction setup.

## Background

Conducting parallel experiments in research essentially saves a lot of time, as well as generates huge amounts of data to enhance the statistical significance of experimental results. Methods to increase the throughput of biological experiments have been widely accepted. However, a major problem with high throughput experiments is the lack of software tools for analysis of the huge amount of data generated.

Here, we have developed a software tool to automate analysis and graphical visualization of fluorescence reader output files. Our open-source python script facilitates generation of kinetic traces from the fluorescence readings and computation of features like the maxima, minima, endpoint, and slope of the kinetic traces. This package is particularly useful for the analysis of fluorescence reporter assays, generating heatmaps to visualize the effect of titrating up to two reagents in the reaction setup. The PyFluor package can be utilized in conjunction with our previously developed PyEcho package for application in Cell-free synthetic biology experiments. These tools will be useful for the analysis of high-throughput fluorescence output biological experiments and beneficial for researchers without programming experience.

## Functionalities

Python functions from the two scripts in this module can be used for the following purposes:

| **Description** | **Script Name** | **Function Called** |
| --- | --- | --- |
| Generates heatmaps in the microplate format for visual representation of the maxima, minima, endpoint, and slope of the fluorescence kinetic traces
 | visualization.py | output\_plots(total\_rows, total\_columns, [\*fluor\_labels], sheet\_name, fluor\_file) |
| Generates fluorescence kinetic traces within the microplate interactive grid format for visualization of the experiment
 | visualization.py | kinetic\_trace(total\_rows, total\_columns, [\*fluor\_labels], sheet\_name, fluor\_file) |
| Generates two interactive plots in a matrix format based on the reaction setup. The first grid shows selected kinetic traces and the second is a maximum fluorescence value heatmap
 | fluor\_analysis.py | expt\_plots(total\_rows, total\_columns, [\*fluor\_labels], [\*expt\_tags], sheet\_name, design\_file, fluor\_file, answer\_tag) |

One can directly call the desired functions on the terminal from their corresponding Python scripts. However, more information regarding the arguments has been included within the scripts, and these scripts have been designed to be modulated as per the user&#39;s requirements.

To create a design table for the analysis please refer to the documentation of generate\_blank\_design\_table.py from the PyEcho module. A description on how to fill up the Design table spreadsheet is also given in the same documentation.

## **Usage of the Python Scripts**

### **Script #1:** __*visualization.py*__

If you open this script on an IDLE, immediately after the import statements, you will see an assignment section in the Script (see Figure 1). Variables in this section can be assigned by the user before running the script as per requirements of the experiment.

![](RackMultipart20210825-4-1aar2jy_html_c67aa2d2e0aee477.png)

_Figure 1: visualization.py opened on PyCharm_

After completing the assignment, the user can directly run the script. If you scroll to the end of the python script, you can see two functions, namely _&quot;output\_plots&quot;_ and _&quot;kinetic\_trace&quot;_, being called with the appropriate arguments.

![](RackMultipart20210825-4-1aar2jy_html_91b2c2c4e32eb4e8.png)

_Figure 2: Last three lines of visualization.py_

If you want to call only one of the functions, you can do so by commenting the other function (adding a &quot;#&quot; in front of the function you don&#39;t want to call). The desired plots will be generated by running this Python script.

Calling the _&quot;output\_plots&quot;_ function will generate heatmaps in the microplate format displaying features such as maxima, minima, endpoint, and slope of the fluorescence kinetic traces. Calling the _&quot;kinetic\_trace&quot;_ function will generate fluorescence kinetic traces within the microplate interactive grid format. These grids will be useful for visualization of experiments with very high throughput. Both the graphical representations can be used to describe the experiment design and results to peers and colleagues.

### **Script #1:** __*fluor\_analysis.py*__

If you open this script on an IDLE, immediately after the import statements, you will see an assignment section in the Script (see Figure 3). Variables in this section shall be assigned before running the script.

![](RackMultipart20210825-4-1aar2jy_html_9d83514711b76de8.png)

_Figure 3: fluor\_analysis.py opened on PyCharm_

In the end of the script, the function _&quot;expt\_plots&quot;_ has been called with the appropriate arguments. The desired plots will be generated by running this Python script.

![](RackMultipart20210825-4-1aar2jy_html_1f72a43e4920ad3b.png)

_Figure 4: last two lines of fluor\_analysis.py_

Calling _&quot;expt\_plots&quot;_ will generate 2 kinds of interactive grids for each of the fluorescence labels with the X-axis and Y-axis representing the two reagents being titrated (tags assigned to the &quot;expt&quot; variable) in the reaction setup. The first grid shows selected kinetic traces and the second grid is a heatmap showing the maximum fluorescence value.

## Variable Assignment:

Most of the variables are quite straightforward, however, some important points must be kept in mind while assigning values.

- Please double-check the name of the file before assigning it to the variable &quot; **fluor\_file**&quot;, &quot; **file\_in**&quot; or &quot; **file\_out**&quot;. Also make sure that the input files are in the same directory as the script, else assign the proper path of the file.
- &quot; **file\_in**&quot; in the script _fluor\_analysis.py_ refers to the design table of the experiment. For more information on how to generate the design table, please refer to the PyEcho package.
- The fluorescence tags used in the experiment and detected by the fluorescence reader must be assigned to the variable &quot; **labels**&quot;. Make sure that the tags are exactly the same as mentioned in the input fluorescence file. Please note that if there are multiple fluorescence tags, please mention them in a python list format\*.
- The _fluor\_analysis.py_ script generates grids with X-axis and Y-axis representing the two reagents being titrated. For proper functioning of this script, it is important to assign the &quot; **expt**&quot; and &quot; **answer**&quot; variables.
- For the &quot; **expt**&quot; variable, exactly two experiment tags must be assigned in a python list format\*. These tags would represent the X-axis and Y-axis respectively on the output grid and these tags must be the exact same as the reagent tags mentioned in the input design table.
- Generally, there are more than two reagents in the reaction setup. If the reagents other than the experiment tags are also being titrated, &quot;yes&quot; must be assigned to the &quot; **answer**&quot; variable. Else, if all the other reagents are constant throughout the reaction setup, &quot;no&quot; must be assigned to the &quot; **answer**&quot; variable.

_\*Python list format:_

_variable = [&quot;label1&quot;, &quot;label2&quot;, â€¦. , &quot;labelN&quot;]_

**Note:**

If you wish to run the script on your PC or Desktop, make sure you have the latest version of Python installed on your system ([https://www.python.org/downloads/](https://www.python.org/downloads/)). The script has been developed using Python 3.8 (32-bit). Also, you might have to install openpyxl, pandas, XlsxWriter, seaborn, etc. in your environment or using the command line terminal. You can refer to the following links if you need help on installing packages/modules: [https://packaging.python.org/tutorials/installing-packages/](https://packaging.python.org/tutorials/installing-packages/); [https://docs.python.org/3/installing/index.html](https://docs.python.org/3/installing/index.html)

If you are comfortable using the Command line you can directly call the desired functions on the terminal from their corresponding Python scripts with the respective arguments (follow the previous section for details regarding the arguments).

However, if you are more comfortable visualizing the code on a Python IDLE, you can use PyCharm ([https://www.jetbrains.com/pycharm/download/](https://www.jetbrains.com/pycharm/download/)), Spyder ([https://www.spyder-ide.org/](https://www.spyder-ide.org/)) or even the official IDLE that is automatically installed with Python. Using an IDLE will help the user to customize the script as required.
